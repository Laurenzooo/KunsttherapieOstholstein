---
import BaseLayout from '../../layouts/Layout.astro';
import { Layout } from '../../components/layout/Layout';
import { client, urlFor } from '../../lib/sanity';

const posts = await client.fetch(`*[_type == "post"] | order(publishedAt desc) {
  title,
  subheading,
  "slug": slug.current,
  mainImage,
  publishedAt,
  excerpt,
  "categories": categories[]->title
}`);

const categories = await client.fetch(`*[_type == "category"] | order(title asc) {
  title
}`);

import { BlogGrid } from '../../components/blog/BlogGrid';

const formatDate = (dateString: string) => {
	return new Date(dateString).toLocaleDateString('de-DE', {
		day: '2-digit',
		month: 'long',
		year: 'numeric'
	});
};
---

<BaseLayout 
	title="Blog | Mikela Blanck Kunsttherapie"
	description="Einblicke in die Kunsttherapie, kreative Impulse und aktuelle Themen aus meiner Praxis in Eutin, Ostholstein."
>
	<Layout client:load currentPath={Astro.url.pathname}>
		<div class="pt-24 md:pt-32 pb-24">
			<div class="container mx-auto px-4 md:px-6">
				<!-- Header Section -->
				<div class="max-w-3xl mb-16">
					<h1 class="text-4xl md:text-6xl font-light mb-6 text-foreground tracking-tight">
						Blog & Gedanken
					</h1>
					<p class="text-xl text-muted-foreground leading-relaxed">
						Einblicke in die Kunsttherapie, kreative Impulse und aktuelle Themen aus meiner Praxis.
					</p>
				</div>

				<BlogGrid 
					client:load 
					posts={posts} 
					categories={categories} 
				/>
			</div>
		</div>
	</Layout>
</BaseLayout>
